<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data noupdate="0">

		<record id="view_repository_branch_build_search" model="ir.ui.view">
			<field name="name">scm.repository.branch.build.search</field>
			<field name="model">scm.repository.branch.build</field>
			<field name="arch" type="xml">
				<search string="Builds">
					<field name="id" string="Number" />
					<field name="branch_id" />
					<field name="port" />
					<field name="state" />
					<field name="result" />
					<field name="date_start" />
					<field name="date_stop" />
					<field name="time" />
					<field name="age" />
					<group string="Group By" expand="0">
						<filter name="group_branch" string="Branch" context="{'group_by': 'branch_id'}" />
					</group>
				</search>
			</field>
		</record>

		<record id="view_repository_branch_build_tree" model="ir.ui.view">
			<field name="name">scm.repository.branch.build.tree</field>
			<field name="model">scm.repository.branch.build</field>
			<field name="arch" type="xml">
				<tree string="Builds" colors="blue:result=='stable';orange:result=='unstable';red:result=='failed';grey:result=='killed'">
					<field name="id" string="Number" />
					<field name="branch_id" />
					<field name="port" />
					<field name="state" />
					<field name="result" />
					<field name="time_human" />
					<field name="age_human" />
					<field name="last_build_time_human" />
					<button name="stop_container" type="object" string="Stop" icon="STOCK_STOP" attrs="{'invisible': [('state', '=', 'done')]}" />
					<button name="open" type="object" string="Open" icon="STOCK_REDO" attrs="{'invisible': [('state', '!=', 'running')]}" />
				</tree>
			</field>
		</record>

		<record id="view_repository_branch_build_simple_tree" model="ir.ui.view">
			<field name="name">scm.repository.branch.build.simple_tree</field>
			<field name="model">scm.repository.branch.build</field>
			<field name="arch" type="xml">
				<tree string="Builds" colors="blue:result=='stable';orange:result=='unstable';red:result=='failed';grey:result=='killed'">
					<field name="id" string="Number" />
					<field name="port" />
					<field name="state" />
					<field name="result" />
					<field name="time_human" />
					<field name="age_human" />
					<field name="last_build_time_human" />
					<button name="stop_container" type="object" string="Stop" icon="STOCK_STOP" attrs="{'invisible': [('state', '=', 'done')]}" />
					<button name="open" type="object" string="Open" icon="STOCK_REDO" attrs="{'invisible': [('state', '!=', 'running')]}" />
				</tree>
			</field>
		</record>

		<record id="view_repository_branch_build_graph" model="ir.ui.view">
			<field name="name">scm.repository.branch.build.graph</field>
			<field name="model">scm.repository.branch.build</field>
			<field name="arch" type="xml">
				<graph string="Builds" type="line">
					<field name="branch_id" type="row" />
					<field name="result" type="col" />
				</graph>
			</field>
		</record>

		<record id="view_repository_branch_build_form" model="ir.ui.view">
			<field name="name">scm.repository.branch.build.form</field>
			<field name="model">scm.repository.branch.build</field>
			<field name="arch" type="xml">
				<form string="Build">
					<header>
						<button name="open" type="object" states="running" string="Open" class="oe_highlight" />
						<field name="state" widget="statusbar" statusbar_visible="pending,testing" />
					</header>
					<sheet>
						<div class="oe_title">
							<h1>
								<label string="Number" />
								<field name="id" class="oe_inline" />
							</h1>
							<label for="branch_id" />
							<field name="branch_id" class="oe_inline" />
						</div>
						<group col="4">
							<group>
								<field name="result" />
								<field name="time_human" />
								<field name="age_human" />
							</group>
							<group>
								<field name="host" />
								<field name="port" />
							</group>
						</group>
						<notebook>
							<page string="Logs">
								<field name="log_ids" readonly="1" context="{'tree_view_ref': 'smile_ci.view_repository_branch_build_log_simple_tree'}" />
							</page>
							<page string="Coverage">
								<field name="coverage_ids" readonly="1" context="{'tree_view_ref': 'smile_ci.view_repository_branch_build_coverage_simple_tree'}" />
							</page>
						</notebook>
					</sheet>
					<div class="oe_chatter">
						<field name="message_follower_ids" widget="mail_followers" />
						<field name="message_ids" widget="mail_thread" />
					</div>
				</form>
			</field>
		</record>

		<record model="ir.actions.act_window" id="action_repository_branch_build">
			<field name="name">Builds</field>
			<field name="res_model">scm.repository.branch.build</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form,graph</field>
			<field name="view_id" ref="view_repository_branch_build_tree" />
			<field name="search_view_id" ref="view_repository_branch_build_search" />
		</record>

		<menuitem id="menu_repository_branch_build" parent="smile_scm.menu_scm" action="action_repository_branch_build" sequence="30" />

	</data>
</openerp>
